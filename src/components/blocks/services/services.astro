---
import './style.scss';

// Components
import { Image } from 'astro:assets';
import Button from '@/components/atoms/button/button.astro';

// Assets
import dash from '@/assets/images/svg/dash-white.svg';
import servizi from '@/assets/images/svg/servizi.svg';

const {
    services = [
        {
            name: "Servizio",
            description: "Descrizione servizio",
            image: null,
            imageAlt: 'service-image'
        }
    ]
} = Astro.props;

---

<section class="services z-10 relative header-dark bg-light pb-lgMobile md:py-lg ">
    <div class="services-tab absolute top-0 -translate-y-[calc(100%-1px)] row-start-1 row-end-2 overflow-hidden left-0 w-full grid grid-cols-12 gap-x-2 md:gap-x-3 px-5 md:px-12 items-end">
        <div class={`services-tab-inner relative col-span-9 md:col-span-7 grid items-end grid-cols-9 md:grid-cols-7 gap-x-2 md:gap-x-3 bg-light pt-[60px] md:pt-20 pl-5 md:pl-12 -ml-5 md:-ml-12`}>
            <Image src={servizi} alt="servizi" class='col-start-3 col-span-6 md:pr-6'/>
        </div>
    </div>
    <div class="grid-container pt-mdMobile bg-light relative">
        <div class="content row-start-2 md:row-start-1 col-start-3 col-end-13 md:col-end-8">
            <div class="services-list mb-11 md:mb-20">
                {services.map((service, id) => (
                <div class={`single-service flex gap-x-2 md:gap-x-4 items-center mb-4 ${id === 0 ? 'selected' : ''}`}>
                        <Image src={dash} alt="dash" class='dash h-2 md:h-6 w-7 md:w-20'/>
                        <h2 class="opacity-30">{service.name}</h2>
                    </div>
                ))}
            </div>
            <div class="service-descriptions">
                {services.map((service, id) => (
                    <div class={`single-service-description ${id !== 0 ? 'hidden' : ''}`}>
                        <p class="h5 mb-11 md:mb-mdMobile">{service.description}</p>
                    <Button
                        label={"Vai al servizio"}
                        url={service.url}
                        style={"primary-variant"}
                    />
                    </div>
                ))}
            </div>
        </div>
        <div class="image col-start-3 md:col-start-8 col-end-13 max-md:mb-11">
            {services.map((service, id) => (
                <Image src={service.image} alt={service.imageAlt} class={`single-service-image ${id !== 0 ? 'hidden' : ''}`}/>
            ))}
        </div>
    </div>
</section>

<script>
    const services = Array.from(document.querySelectorAll('section.services .single-service'));
    const serviceDescriptions = document.querySelectorAll('section.services .single-service-description');
    const serviceImages = document.querySelectorAll('section.services .single-service-image');

    let lastSelected = null;
    services.forEach(service => {
        service.addEventListener('click', () => {
            services.forEach(disableService => {
                disableService.classList.remove('selected');
            })
            serviceDescriptions.forEach(disableServiceDescription => {
                disableServiceDescription.classList.add('hidden');
            })
            serviceImages.forEach(disableServiceDescription => {
                disableServiceDescription.classList.add('hidden');
            })

            service.classList.add('selected');
            serviceDescriptions[services.indexOf(service)].classList.remove('hidden');
            serviceImages[services.indexOf(service)].classList.remove('hidden');
        })
    })
</script>